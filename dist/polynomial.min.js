/*
Polynomial.js v1.5.3 10/9/2024
https://github.com/rawify/Polynomial.js

Copyright (c) 2024, Robert Eisele (https://raw.org/)
Licensed under the MIT license.
*/
'use strict';(function(A){function w(a){return function(){var c=this.coeff,d=[];for(f in c)d.push(+f);if(0===d.length)return"0";d.sort(function(m,n){return m-n});for(var b="",e=d.length;e--;){var f=d[e];var l=c[f],g=l;if(null!==g&&void 0!==g)if(Complex&&g instanceof Complex){if(0!==g.re){""!==b&&0<g.re&&(b+="+");if(-1===g.re&&0!==f)b+="-";else if(1!==g.re||0===f)b+=g.re;1===f?b+="x":0!==f&&(b+="x^"+f)}0!==g.im&&(""!==b&&0<g.im&&(b+="+"),-1===g.im?b+="-":1!==g.im&&(b+=g.im),b+="i",1===f?b+="x":0!==
f&&(b+="x^"+f))}else if(g=g.valueOf(),0!==g){""!==b&&0<g&&(b+="+");if(-1===g&&0!==f)b+="-";else if(1!==g||0===f)b+=l[a]?l[a]():l.toString();1===f?b+="x":0!==f&&(b+="x^"+f)}}return""===b?l[a]?l[a]():l.toString():b}}function p(a){var c={};if(null===a||void 0===a)a=0;switch(typeof a){case "object":a.coeff&&(a=a.coeff);if(Fraction&&a instanceof Fraction||Complex&&a instanceof Complex||Quaternion&&a instanceof Quaternion)c[0]=a;else for(var d in a)k.empty(a[d])||(c[d]=k.parse(a[d]));return c;case "number":return{0:k.parse(a)};
case "string":for(;null!==(d=B.exec(a));){var b=1,e=1;void 0!==d[4]?(b=d[4],e=0):void 0!==d[2]&&(b=d[2]);var f=d[1];b=String(b).match(/[^*/]+|[*/]/g);f=k.parse(f+b[0]);for(var l=1;l<b.length;l+=2)"*"===b[l]?f=k.mul(f,k.parse(b[l+1]||1)):"/"===b[l]&&(f=k.div(f,k.parse(b[l+1]||1)));b=f;void 0!==d[3]&&(e=parseInt(d[3],10));c[e]=void 0===c[e]?b:k.add(c[e],b)}return c}throw"Invalid Param";}function v(a,c){for(var d={},b=r(a),e=r(c),f=[];b>=e;){var l=d[b-e]=k.div(a[b]||0,c[e]||0),g;for(g in c)a[+g+b-e]=
k.sub(a[+g+b-e]||0,k.mul(c[g]||0,l));if(null!==h.trace){var m={};for(g in c)m[+g+b-e]=k.mul(c[g]||0,l);f.push(new h(m))}b=r(a)}null!==h.trace&&(f.push(new h(a)),h.trace=f);return d}function x(a,c){var d=1;for(c=a-c;c<a;a--)d*=a;return d}function h(a){if(!(this instanceof h))return new h(a);this.coeff=p(a)}function t(a){var c={},d;for(d in a)c[d]=a[d];return c}function y(a,c){var d={},b;for(b in a)d[b]=1;for(b in c)d[b]=1;return d}function r(a){var c=-Infinity,d;for(d in a)k.empty(a[d])||(c=Math.max(d,
c));return c}function u(a){var c=null,d;for(d in a)!k.empty(a[d])&&(null===c||+c<+d)&&(c=d);return c}function z(a,c){if(null!==c)for(var d in a)a[d]=k.div(a[d],a[c]);return a}var k={add:function(a,c){return a+c},sub:function(a,c){return a-c},mul:function(a,c){return a*c},div:function(a,c){if(0===c)throw"DIV/0";return a/c},parse:function(a){return parseFloat(a)},empty:function(a){return!a},pow:function(a,c){return Math.pow(a,c)},equals:function(a,c){return a===c}},C=k,B=/([+-]?)(?:([^+x-]+)?(?:x(?:\^([\d\/]+))?)|([^+x-]+))/g;
h.trace=null;h.prototype.coeff={};h.prototype.gcd=function(a){var c=t(this.coeff);for(a=p(a);!(0>r(a));){var d=t(c);v(d,a);c=a;a=d}a=u(c);return new h(z(c,a))};h.prototype.neg=function(){var a={},c=this.coeff,d;for(d in c)a[d]=k.mul(c[d],-1);return new h(a)};h.prototype.reciprocal=function(){var a={},c=this.coeff,d=r(c),b;for(b in c)a[d-b]=c[b];return new h(a)};h.prototype.eval=function(a){var c=this.coeff,d=r(c);if(0>d)return 0;var b=c[d];for(--d;0<=d;d--)b=k.mul(b,a),k.empty(c[d])||(b=k.add(b,c[d]));
return b};h.prototype.lc=function(){var a=u(this.coeff);return this.coeff[a]};h.prototype.lm=function(){var a=u(this.coeff),c={};c[a]=this.coeff[a];return new h(c)};h.prototype.monic=function(){return new h(z(t(this.coeff),u(this.coeff)))};h.prototype.add=function(a){a=p(a);var c={},d=this.coeff,b=y(a,d),e;for(e in b)c[e]=k.add(d[e]||0,a[e]||0);return new h(c)};h.prototype.sub=function(a){a=p(a);var c={},d=this.coeff,b=y(a,d),e;for(e in b)c[e]=k.sub(d[e]||0,a[e]||0);return new h(c)};h.prototype.mul=
function(a){a=p(a);var c={},d=this.coeff;for(b in a){var b=+b;for(var e in d)e=+e,c[b+e]=k.add(c[b+e]||0,k.mul(a[b]||0,d[e]||0))}return new h(c)};h.prototype.addmul=function(a,c){a=p(a);c=p(c);var d={};for(b in a){var b=+b;for(var e in c)e=+e,d[b+e]=k.add(d[b+e]||0,k.mul(a[b]||0,c[e]||0))}return this.add(d)};h.prototype.div=function(a){return new h(v(t(this.coeff),p(a)))};h.prototype.pow=function(a){if(isNaN(a)||0>a||a%1)throw"Invalid";for(var c=new h(1),d=this;0<a;)a&1&&(c=c.mul(d)),d=d.mul(d),a>>=
1;return c};h.prototype.mod=function(a){var c=t(this.coeff);v(c,p(a));return new h(c)};h.prototype.derive=function(a){if(void 0===a)a=1;else if(0>a)return null;var c=this.coeff,d={},b;for(b in c)+b>=a&&(d[b-a]=k.mul(c[b]||0,x(+b,a)));return new h(d)};h.prototype.integrate=function(a){if(void 0===a)a=1;else if(0>a)return null;var c=this.coeff,d={},b;for(b in c)d[+b+a]=k.div(c[b]||0,x(+b+a,a));return new h(d)};h.fromRoots=function(a){function c(g){switch(g.length){case 0:return e;case 1:return new h([k.mul(g[0],
-1),1]);default:var m=Math.floor(g.length/2),n=g.slice(m,g.length);return c(g.slice(0,m)).g(c(n))}}var d=a.length,b=k.parse(0);a=a.filter(g=>!k.equals(g,b));d-=a.length;var e=new h(k.parse(1));a=c(a).coeff;var f={},l;for(l in a)f[d+parseInt(l,10)]=a[l];return new h(f)};h.prototype.toString=w("toString");h.prototype.toLatex=w("toLatex");h.prototype.toHorner=function(){function a(f,l){var g="";Complex&&f instanceof Complex?0===f.im?(0<f.re&&l&&(g+="+"),g+=f.re):0===f.re?(-1===f.im?g+="-":1!==f.im?(0<
f.im&&l&&(g+="+"),g+=f.im):0<f.im&&l&&(g+="+"),g+="i"):(l&&(g+="+"),g=g+"("+f.toString(),g+=")"):(0<f&&l&&(g+="+"),g+=f.toString());return g}function c(f,l){var g=f.length-l-1,m=f[g]-(f[g-1]||0),n="",q="";0<m&&(n="x",1<m&&(n+="^"+m));0<g&&(n+=a(d[f[g-1]],!0));if(0===l)return a(d[f[g]],!1)+n;0<=g&&f[g]&&(q+="(");q+=c(f,l-1);0<=g&&f[g]&&(q+=")");return q+n}var d=this.coeff,b=[],e;for(e in d)k.empty(d[e])||b.push(+e);if(0===b.length)return"0";b.sort(function(f,l){return f-l});return c(b,b.length-1)};
h.prototype.clone=function(){return new h(this)};h.prototype.degree=function(){return r(this.coeff)};h.setField=function(a){var c={Q:Fraction,C:Complex,H:Quaternion}[a];if(void 0!==c)k={add:function(b,e){return(new c(b)).add(e)},sub:function(b,e){return(new c(b)).sub(e)},mul:function(b,e){return(new c(b)).mul(e)},div:function(b,e){return(new c(b)).div(e)},parse:function(b){return new c(b)},empty:function(b){return(new c(b)).equals(0)},pow:function(b,e){return(new c(b)).pow(e)},equals:function(b,e){return(new c(b)).equals(e)}};
else if(!a||"R"===a)k=C;else if("object"===typeof a)k=a;else if("Z"===a.charAt(0)){var d=+a.slice(1);k={add:function(b,e){return((b+e)%d+d)%d},sub:function(b,e){return((b-e)%d+d)%d},mul:function(b,e){return(b*e%d+d)%d},div:function(b,e){for(var f=d,l=0,g=1,m=1,n=0;0!==e;){var q=f/e|0,D=f%e,E=l-m*q;q=g-n*q;f=e;e=D;l=m;g=n;m=E;n=q}e=[f,l,g];if(1!==e[0])throw"DIV/-";return(b*e[1]%d+d)%d},parse:function(b){return parseInt(b,10)},empty:function(b){return void 0===b||0===b},pow:function(b,e){for(var f=
1;0<e;b=(b*b%d+d)%d,e>>=1)e&1&&(f=(f*b%d+d)%d);return f},equals:function(b,e){return b==e}}}};"function"===typeof define&&define.amd?define([],function(){return h}):"object"===typeof exports?(Object.defineProperty(h,"__esModule",{value:!0}),h["default"]=h,h.Polynomial=h,module.exports=h):A.Polynomial=h})(this);
